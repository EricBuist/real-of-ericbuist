<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta name="generator"
      content="HTML Tidy for Java (vers. 2009-12-01), see jtidy.sourceforge.net" />
      <title>
         L'imprimante kidnappée
      </title>
      <meta http-equiv="Content-Type"
      content="application/xhtml+xml; charset=UTF-8" />
      <meta name="author" content="Eric Buist" />
      <meta name="viewport"
      content="width=device-width, initial-scale=1.0" />
      <meta name="HandheldFriendly" content="true" />
      <link rel="stylesheet" type="text/css"
      href="../../main.css" />
   </head>
   <body>
      <table class="topnavbar" width="100%">
         <tr>
            <td class="parents" colspan="3">
               <a href="../../index.xhtml" class="parents">Le
               royaume de Eric Buist</a> &gt;&gt; <a
               href="../index.xhtml"
               class="parents">Informatique</a> &gt;&gt; Problèmes
               marquants &gt;&gt; <a href="../resolved.xhtml"
               class="parents">Quelques bogues résolus</a> &gt;&gt;
               <a href="index.xhtml" class="parents">Bogues
               logiciels résolus</a>
            </td>
         </tr>
         <tr>
            <td class="contact">
               <a href="../../contact.xhtml" class="contact">Me
               contacter</a>
            </td>
            <td class="topnavbar">
            </td>
            <td class="sitemap">
               <a href="../../sitemap.xhtml" class="sitemap">Plan
               du site</a>
            </td>
         </tr>
         <tr>
            <td class="leftsibling">
               &lt;&lt; <a href="cdrwerasebug.xhtml"
               class="leftsibling">Problème lors de l'effacement
               des CD-RW</a>
            </td>
            <td class="thispage">
               L'imprimante kidnappée
            </td>
            <td class="rightsibling">
               <a href="msnvirus.xhtml" class="rightsibling">Virus
               sur MSN</a> &gt;&gt;
            </td>
         </tr>
      </table>
      <h1>
         L'imprimante kidnappée
      </h1>
      <p>
         Dimanche, 15 juillet 2001, je me suis dit qu'il était
         temps de tenter de trouver un moyen d'utiliser mon modem
         comme un téléphone main libre, et cela sous Windows 2000.
         Pour y parvenir, il me fallait un fil de téléphone
         suffisamment long pour relier l'appareil à la prise
         murale, ce que je possédais à ce moment-là. Le second
         élément, non moins essentiel, constitue le logiciel.
         J'avais déjà essayé avec le logiciel RapidComm, sans grand
         succès, car ce programme venait avec mon ancien modem U.S.
         Robotics et semblait conçu pour cet appareil plus qu'autre
         chose. À noter que le modem ne venait pas avec un tel
         logiciel, sinon il n'y aurait pas eu de bogue... Grâce au
         forum de <a href="http://www.kt3ztv.com">KT3Z</a>, j'ai
         découvert le logiciel Bitware qui pourrait solutionner le
         problème. Malheureusement, je n'ai pu trouver qu'une
         vieille version qui semblait 16 bits. Mais en désespoir de
         cause...
      </p>
      <p>
         J'ai donc installé Cheyenne Bitware sous Windows 2000, ce
         qui s'est bien passé et a ajouté une imprimante dans la
         liste, une imprimante poison comme on verra! Le logiciel
         n'a pas fonctionné du tout question modem vocal. Le bouton
         Voix du programme faisait surgir une nouvelle fenêtre dans
         laquelle je pouvais travailler. Régler l'unité
         d'enregistrement à modem puis cliquer sur le bouton
         d'enregistrement provoquait un message d'information puis
         rien ne se passait, l'enregistrement ne démarrait pas.
         L'enregistrement avec la carte son, dans Bitware,
         provoquait des erreurs de conversion de formats!
      </p>
      <p>
         Je suis allé essayer sous Sound Forge, puisque le pilote
         du modem installe des pilotes multimédia pour ses
         fonctions vocales, mais cela ne fonctionnait pas du tout
         là non plus. La machine a finalement commencé à mal
         répondre, l'appui sur Enter dans le menu Démarrer ne
         provoquait pas toujours de résultat, j'ai fini par me
         choquer et redémarrer sous Windows ME.
      </p>
      <p>
         De là, où le problème du modem vocal sévissait là aussi,
         j'ai tenté de désinstaller le pilote Intel pour
         réinstaller l'ancien pilote Ambient Technologies livré
         avec le cossin. Par bonheur, cela n'a rien donné et j'ai
         réinstallé le nouveau pilote! Oui par bonheur, parce que
         si ce modem ne fonctionne qu'avec les drivers livrés sur
         le CD et qu'on ne peut pas les mettre à jour par Internet,
         je serai bloqué question systèmes d'exploitation dans le
         futur.
      </p>
      <p>
         Bon, ce test effectué, il était temps de revenir sous
         Windows 2000, que je préfère pour sa stabilité à Windows
         ME. Mais un joli message d'erreur m'attendait:
         l'application SPOOLSV.EXE avait planté au démarrage de
         Windows. J'ai tout d'abord cru à une erreur passagère et
         je ne m'en suis pas trop soucié. Voulant poursuivre les
         investigations, je me suis mis à chercher dans le Panneau
         de Configuration quelque chose qui pourrait m'aider, une
         option de téléphonie par exemple. Je suis tombé sur une
         option de Télécopieur et je suis allé voir par curiosité.
         Un bouton Ajouter un télécopieur m'a alors inquiété, car
         Télécopieur apparaît dans la liste des imprimantes,
         habituellement. Il me fallait donc vérifier, dans le menu
         Démarrer, Paramètres, j'ai sélectionné Imprimantes et puis
         un choc brutal: plus rien! Toutes les imprimantes avaient
         disparu!
      </p>
      <p>
         J'étais en méchant fusil, cela allait être de la belle
         merde de réparer ces jolis dégâts! Il allait me falloir
         rajouter l'imprimante Canon, puis l'Epson. Ensuite il me
         faudrait rajouter le Télécopieur même s'il ne sert pas,
         puis il me faudrait réinstaller Adobe Acrobat pour ravoir
         PDF Writer. Je n'étais pas trop content, surtout que je
         n'avais rien fait pour mériter ce méchant traitement!
      </p>
      <p>
         Avant de le faire, je suis allé sous Microsoft Word 2000
         et j'ai tenté d'imprimer une page de test, sans aucun
         succès. Un message d'erreur a été le seul fruit de ma
         commande. Bon, il allait falloir recommencer. Je suis
         retourné dans la boîte des imprimantes, puis j'ai demandé
         d'ajouter une nouvelle imprimante. Le système m'a alors
         déclaré que les ressources étaient insuffisantes, il ne
         pouvait ajouter l'imprimante! SPOOLSV.EXE, ça devait
         servir à cela...
      </p>
      <p>
         Réflexe de l'utilisateur Windows: redémarrer! Ce que je
         fis en espérant que cela fasse un miracle. SPOOLSV.EXE a
         replanté au démarrage et les imprimantes étaient toujours
         absentes. C'était Bitware le poison, je le désinstallai et
         un nouveau redémarrage s'imposa. Et le problème revint...
         C'était maintenant pire, car Bitware ne s'était pas
         désinstallé correctement et il cherchait des fichiers!
      </p>
      <p>
         Il m'a fallu modifier la base de Registre, si je me
         souviens bien, afin de désactiver ce qui démarrait
         automatiquement lors du démarrage du système, mais cela
         n'aida pas pour l'imprimante. Je tentai alors de me rendre
         dans le Panneau de Configuration, Outils d'Administration,
         Services, puis j'ai vu le spouleur que j'ai réactivé
         manuellement. Cela a fonctionné, mais il s'est planté dès
         que j'ai activé la boîte des paramètres d'impression.
         Hypothèse: Bitware avait installé une imprimante 16 bits
         que Windows 2000 n'aimait pas et cela ne pouvait plus
         décoller de là!
      </p>
      <p>
         Je commençais à craindre qu'il allait falloir réinstaller
         Windows au complet pour régler le problème. Peut-être
         qu'en réinstallant Windows par-dessus ce qui était déjà
         là, le problème serait corrigé, mais je savais que des
         fichiers seraient écrasés et qu'il me faudrait quand même
         réinstaller des affaires après le massacre. Cela ne me
         plaisait pas du tout et me choquait au plus haut point.
      </p>
      <p>
         Une modification dans la base de Registre a été tentée,
         puis un redémarrage du spouleur, problème lors de l'accès
         aux imprimantes! Un redémarrage n'a rien réglé. Il me
         fallut quelques autres modifications dans le Registre
         consistant à supprimer l'imprimante Bitware en-dessous de
         la couverte, une réactivation du spouleur puis les
         imprimantes étaient de nouveau accessibles! Je venais
         d'éviter la catastrophique réinstallation!
      </p>
      <p>
         Je ne me souviens plus de quelles valeurs du Registre j'ai
         supprimées, car j'y suis allé par tâtonnement avec à
         chaque fois un faible degré de probabilité de résolution
         du problème. La recherche des endroits se basait sur
         l'hypothèse selon laquelle Windows écrit en clair la liste
         de chacun des noms des imprimantes. Cette conjecture vient
         du fait que l'utilisateur peut, à sa guise, baptiser
         chaque imprimante comme bon lui semble. Je savais que
         j'avais une imprimante appelée <i>Canon BJC-250</i>, alors
         je recherchai <i>Canon</i> et trouvai des clés contenant
         différentes valeurs. Si la clé trouvée contenait les noms
         des imprimantes, ainsi que BitWare, je pouvais supprimer
         la valeur de BitWare seulement, sans affecter le reste.
         J'ai aussi effectué une recherche de la chaîne
         <i>BitWare</i> afin de supprimer toute trace du dangereux
         programme! Les informations des imprimantes se trouvent
         groupées sous la clé
         <tt>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows
         NT\CurrentVersion\Print\Printers</tt>, chaque imprimante
         constituant une sous-clé. Pour supprimer une imprimante
         manuellement, il suffit de supprimer la sous-clé
         correspondante. Cette technique n'est pas idéale, car les
         fichiers des pilotes restent sur le disque dur. Toutefois,
         elle pourrait permettre de déboguer le spouleur
         d'impression et il y a de bonnes chances que j'aie
         effectivement supprimé une sous-clé de cette clé. Il est
         aussi possible de trouver des références aux imprimantes
         sous les clés
         <tt>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Environment\Windows
         NT x86\Drivers\Version-3</tt> et
         <tt>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers</tt>.
      </p>
      <p>
         La morale de cette histoire: ne jamais installer Cheyenne
         Bitware sous Windows 2000! Je préfère ne pas disposer du
         téléphone main libre que devoir utiliser ce logiciel
         seulement sous Windows 98/ME. Mes recherches ultérieures
         ne m'ont procuré aucun logiciel du genre, c'est à croire
         que cela ne se fait pas... Ce qui suscite chez moi de
         nombreuses interrogations au sujet de l'utilité d'un voice
         modem, à part pour servir de modem et de fax.
      </p>
      <div class="footer">
         <a href="http://validator.w3.org/check?uri=referer"><img
         src="http://www.w3.org/Icons/valid-xhtml10"
         alt="Valid XHTML" height="31" width="88" /></a><a
         href="http://jigsaw.w3.org/css-validator/check/referer"><img
          src="http://jigsaw.w3.org/css-validator/images/vcss"
         alt="Valid CSS" height="31" width="88" /></a>
      </div>
   </body>
</html>

